# Comando /find-unused-code

Detecta y analiza c√≥digo, variables, funciones, imports y archivos que no se utilizan en tu proyecto para optimizaci√≥n y limpieza.

## üìã Descripci√≥n

El comando `/find-unused-code` es una herramienta avanzada de an√°lisis est√°tico que identifica c√≥digo sin uso para:

- **Optimizar bundle size**: Reducir el tama√±o final de la aplicaci√≥n
- **Mejorar performance**: Eliminar c√≥digo que ralentiza la carga
- **Facilitar mantenimiento**: Limpiar c√≥digo legacy y obsoleto
- **Prevenir confusi√≥n**: Remover c√≥digo que ya no tiene prop√≥sito
- **Ahorrar espacio**: Liberar espacio en el repositorio

## üéØ An√°lisis Completo

### Categor√≠as de Detecci√≥n

#### üî¢ Variables No Utilizadas
```javascript
// ‚ùå DETECTADO: Variable declarada sin uso
const unusedVariable = computeExpensiveValue();
const result = otherFunction();

// ‚ùå DETECTADO: Destructuring parcial
const { used, unused } = getData();
console.log(used); // unused nunca se usa

// ‚ùå DETECTADO: Par√°metros de funci√≥n
function process(data, unusedParam) {
  return data.map(item => item.value);
}
```

#### ‚öôÔ∏è Funciones Sin Referencias
```javascript
// ‚ùå DETECTADO: Funci√≥n nunca llamada
function calculateDiscount(price, rate) {
  return price * (1 - rate);
}

// ‚ùå DETECTADO: Arrow function sin uso
const formatCurrency = (amount) => `$${amount.toFixed(2)}`;

// ‚ùå DETECTADO: M√©todo de clase sin invocar
class Utils {
  static formatDate(date) { // Nunca llamado
    return date.toISOString();
  }
}
```

#### üì¶ Imports/Exports Innecesarios
```javascript
// ‚ùå DETECTADO: Import sin uso
import { useState, useEffect, useCallback } from 'react';
import lodash from 'lodash';
import moment from 'moment';

// Solo useState se usa en el componente
function Component() {
  const [count, setCount] = useState(0);
  return <div>{count}</div>;
}

// ‚ùå DETECTADO: Export sin referencias externas
export const unusedUtility = () => {};
export default UnusedComponent; // Nunca importado
```

#### üß© Componentes React
```jsx
// ‚ùå DETECTADO: Componente nunca renderizado
function UnusedButton({ onClick, children }) {
  return <button onClick={onClick}>{children}</button>;
}

// ‚ùå DETECTADO: Hook personalizado sin uso
function useUnusedHook() {
  const [state, setState] = useState(null);
  return [state, setState];
}

// ‚ùå DETECTADO: Context sin provider/consumer
const UnusedContext = createContext();
```

#### üìÅ Archivos Sin Referencias
```
‚ùå DETECTADO: Archivos completamente sin uso
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ OldButton.tsx        ‚Üê Sin imports
‚îÇ   ‚îî‚îÄ‚îÄ DeprecatedModal.tsx  ‚Üê Sin referencias
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ legacy.js           ‚Üê Archivo obsoleto
‚îÇ   ‚îî‚îÄ‚îÄ helpers-old.js      ‚Üê Version antigua
‚îî‚îÄ‚îÄ hooks/
    ‚îî‚îÄ‚îÄ useOldApi.ts        ‚Üê Hook legacy
```

#### üé® CSS/Estilos No Utilizados
```css
/* ‚ùå DETECTADO: Class no aplicada */
.unused-button-style {
  background: red;
  padding: 10px;
}

/* ‚ùå DETECTADO: ID sin referencias */
#unique-modal {
  position: fixed;
  top: 50%;
}

/* ‚ùå DETECTADO: Keyframes no usados */
@keyframes unused-animation {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ‚ùå DETECTADO: Variables CSS sin uso */
:root {
  --unused-color: #ff0000;
}
```

#### üì¶ Dependencias No Utilizadas
```json
{
  "dependencies": {
    "moment": "^2.29.4",      // ‚ùå No importado
    "lodash": "^4.17.21",     // ‚ùå Sin uso real
    "uuid": "^9.0.0"          // ‚ùå Solo en tests
  },
  "devDependencies": {
    "unused-plugin": "^1.0.0" // ‚ùå No en configs
  }
}
```

## üéõÔ∏è Par√°metros Avanzados

### Sintaxis Completa
```
/find-unused-code [directorio] [opciones]
```

### Opciones Detalladas

| Opci√≥n | Valores | Descripci√≥n | Ejemplo |
|--------|---------|-------------|---------|
| `--tipos` | `variables,funciones,imports,exports,archivos,css,deps,react` | Categor√≠as espec√≠ficas a analizar | `--tipos=variables,imports` |
| `--severidad` | `alto,medio,bajo,todos` | Nivel m√≠nimo de impacto | `--severidad=alto` |
| `--incluir` | `test-files,config-files,type-files` | Categor√≠as especiales a incluir | `--incluir=test-files` |
| `--min-size` | `number` | Tama√±o m√≠nimo en l√≠neas | `--min-size=10` |
| `--max-items` | `number` | M√°ximo items por categor√≠a | `--max-items=20` |
| `--output` | `console,json,html,csv` | Formato de salida | `--output=json` |
| `--bundle-impact` | `true,false` | Calcular impacto en bundle | `--bundle-impact=true` |
| `--suggestions` | `true,false` | Mostrar sugerencias de fix | `--suggestions=true` |

### Ejemplos Pr√°cticos

```bash
# An√°lisis completo del proyecto
/find-unused-code

# Solo variables y funciones en src/
/find-unused-code src/ --tipos=variables,funciones

# Dependencias con alto impacto en bundle
/find-unused-code --tipos=deps --severidad=alto --bundle-impact=true

# Componentes React no utilizados
/find-unused-code components/ --tipos=react --min-size=5

# CSS no utilizado con sugerencias
/find-unused-code styles/ --tipos=css --suggestions=true

# An√°lisis completo incluyendo archivos de test
/find-unused-code --incluir=test-files --output=json

# Archivos grandes sin referencias
/find-unused-code --tipos=archivos --min-size=50 --severidad=alto

# Imports y exports innecesarios
/find-unused-code src/ --tipos=imports,exports --max-items=50
```

## üìä Interpretaci√≥n de Resultados

### Niveles de Severidad

#### üî¥ Alto (Cr√≠tico)
- **Archivos** > 50 l√≠neas sin referencias
- **Dependencias** que impactan > 50KB en bundle
- **Funciones** complejas sin uso
- **CSS** con muchas reglas sin aplicar

#### üü° Medio (Importante)
- **Archivos** 10-50 l√≠neas sin uso
- **Variables** en m√∫ltiples archivos
- **Imports** de librer√≠as grandes
- **Funciones** medianas sin llamadas

#### üü¢ Bajo (Menor)
- **Variables** simples sin uso
- **Imports** peque√±os innecesarios
- **CSS** rules individuales
- **Par√°metros** de funci√≥n sin usar

### M√©tricas de Impacto

```
üíæ AN√ÅLISIS DE IMPACTO:

üì¶ Bundle Size:
‚Ä¢ Reducci√≥n estimada: 127KB (-15.3%)
‚Ä¢ Archivos eliminables: 8 files
‚Ä¢ Dependencies removibles: 3 packages

‚ö° Performance:
‚Ä¢ Menos JS parsing: ~45ms
‚Ä¢ Menos CSS processing: ~12ms
‚Ä¢ Reducci√≥n de memory usage: ~8MB

üßπ C√≥digo:
‚Ä¢ L√≠neas eliminables: 1,247 LOC
‚Ä¢ Archivos limpiables: 23 files
‚Ä¢ Complejidad reducida: -18%
```

## ‚öôÔ∏è Configuraci√≥n Avanzada

### Configuraci√≥n Completa

```json
{
  "severity": "medio",
  "analysis": {
    "variables": {
      "enabled": true,
      "includeParameters": true,
      "includeDestructuring": true,
      "ignorePattern": "^_"
    },
    "functions": {
      "enabled": true,
      "minComplexity": 2,
      "includeArrowFunctions": true,
      "ignoreMethods": ["constructor", "render"]
    },
    "imports": {
      "enabled": true,
      "includeTypeImports": true,
      "ignoreFrameworks": ["react", "next"],
      "analyzeReExports": true
    },
    "exports": {
      "enabled": true,
      "analyzeEntryPoints": true,
      "ignorePublicAPI": false
    },
    "files": {
      "enabled": true,
      "minSize": 5,
      "analyzeTests": false,
      "includeAssets": false
    },
    "css": {
      "enabled": true,
      "includeVariables": true,
      "analyzeKeyframes": true,
      "checkDynamicClasses": true
    },
    "dependencies": {
      "enabled": true,
      "analyzeBundleImpact": true,
      "includeDevDeps": true,
      "checkScripts": true
    }
  },
  "intelligence": {
    "crossFileAnalysis": true,
    "dynamicImportDetection": true,
    "jsxAnalysis": true,
    "typeScriptSupport": true
  }
}
```

### Patrones de Exclusi√≥n

```json
{
  "smartIgnore": {
    "entryPoints": ["index.*", "main.*", "_app.*"],
    "publicAPI": ["export.*public", "API_.*"],
    "frameworkPatterns": [
      "Next.js getStaticProps",
      "React.FC props",
      "Express middleware"
    ],
    "testPatterns": [".*\\.test\\.", ".*\\.spec\\."],
    "configPatterns": [".*\\.config\\.", ".*rc\\."]
  }
}
```

## üöÄ Integraci√≥n con Workflow

### GitHub Actions
```yaml
name: Code Cleanup Analysis

on:
  pull_request:
    branches: [main, develop]
  
jobs:
  unused-code-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Analyze unused code
        run: |
          npx claude-power find-unused-code \
            --output=json \
            --severidad=alto \
            > unused-report.json
            
      - name: Check critical issues
        run: |
          CRITICAL=$(jq '.summary.by_severity.alto' unused-report.json)
          if [ $CRITICAL -gt 0 ]; then
            echo "‚ùå $CRITICAL critical unused code issues found"
            jq '.issues[] | select(.severity == "alto")' unused-report.json
            exit 1
          fi
          
      - name: Comment PR
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            const report = JSON.parse(fs.readFileSync('unused-report.json'));
            const comment = `
            ## üßπ Unused Code Analysis
            
            - **Total unused items**: ${report.summary.total}
            - **Bundle impact**: ${report.summary.bundleImpact}KB
            - **Files cleanable**: ${report.summary.files}
            
            ${report.summary.total > 20 ? '‚ö†Ô∏è Consider cleanup before merge' : '‚úÖ Code looks clean!'}
            `;
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
```

### Pre-commit Hook
```bash
#!/bin/sh
# .git/hooks/pre-commit

echo "üîç Checking for unused code..."

# Ejecutar an√°lisis de c√≥digo no usado
UNUSED_OUTPUT=$(npx claude-power find-unused-code \
  --tipos=variables,imports \
  --severidad=alto \
  --output=console 2>&1)

if [ $? -eq 0 ] && [ ! -z "$UNUSED_OUTPUT" ]; then
  echo "‚ö†Ô∏è Unused code detected:"
  echo "$UNUSED_OUTPUT"
  echo ""
  echo "üí° Consider running: /fix-unused --auto"
  echo "   Or: git commit --no-verify to skip this check"
  exit 1
fi

echo "‚úÖ No critical unused code found"
```

### VS Code Configuration
```json
{
  "tasks": [
    {
      "label": "Find Unused Code",
      "type": "shell",
      "command": "npx",
      "args": [
        "claude-power",
        "find-unused-code",
        "${workspaceFolder}",
        "--suggestions=true"
      ],
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared",
        "showReuseMessage": true,
        "clear": false
      },
      "options": {
        "cwd": "${workspaceFolder}"
      }
    },
    {
      "label": "Unused Code - Quick Scan",
      "type": "shell",
      "command": "npx",
      "args": [
        "claude-power", 
        "find-unused-code",
        "${file}",
        "--tipos=variables,imports"
      ],
      "group": "build"
    }
  ],
  "keybindings": [
    {
      "key": "ctrl+shift+u",
      "command": "workbench.action.tasks.runTask",
      "args": "Find Unused Code"
    }
  ]
}
```

## üéØ Casos de Uso Espec√≠ficos

### Migraci√≥n de Librer√≠as
```bash
# Detectar uso de librer√≠a antigua antes de migrar
/find-unused-code --tipos=imports --severidad=todos | grep "moment"

# Verificar que toda la librer√≠a se puede remover
/find-unused-code --tipos=deps --bundle-impact=true
```

### Limpieza de Features Legacy
```bash
# Encontrar componentes de feature antigua
/find-unused-code src/features/old-feature/ --tipos=archivos,react

# Verificar dependencias espec√≠ficas de la feature
/find-unused-code --tipos=deps | grep "old-feature-lib"
```

### Optimizaci√≥n de Bundle
```bash
# Identificar imports que m√°s impactan el bundle
/find-unused-code --tipos=imports,deps --bundle-impact=true --severidad=alto

# Analizar CSS no utilizado
/find-unused-code styles/ --tipos=css --min-size=1
```

### Auditor√≠a de C√≥digo
```bash
# An√°lisis completo para auditor√≠a
/find-unused-code --output=html --incluir=test-files,config-files

# Generar reporte para stakeholders
/find-unused-code --output=csv --bundle-impact=true
```

## üìà M√©tricas y KPIs

### M√©tricas de Limpieza
- **Dead Code Ratio**: % de c√≥digo sin uso vs total
- **Bundle Impact**: KB reducibles del bundle final
- **Maintainability Index**: Mejora en mantenibilidad
- **Complexity Reduction**: Reducci√≥n de complejidad ciclom√°tica

### Trending Analysis
```bash
# Comparar con an√°lisis anterior
/find-unused-code --output=json > current-unused.json
diff previous-unused.json current-unused.json

# Establecer baseline para el proyecto
/find-unused-code --output=json > baseline-unused.json
```

---

*Herramienta del ecosistema **Claude Power** - Optimiza tu c√≥digo con IA* üöÄ 